<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <title>Car Price Tracking</title>
</head>
<body>
<div style="width: 50%;margin: auto;">
    <h1>Seja bem vindo!</h1>
    <br>

    <label for="marcas">Marca:</label>
    <select class="form-select" name="marcas" id="marcas">
        <option selected value="0">-- Selecione uma marca --</option>
        <option th:each="marca : ${marcas}"
                th:value="${marca.getCodigo()}"
                th:text="${marca.getNome()}">
        </option>
    </select>

    <br>

    <label for="modelos">Modelo:</label>
    <select class="form-select" name="modelos" id="modelos" disabled>
        <option selected value="0">-- Selecione um modelo --</option>
    </select>

    <!-- A tabela abaixo continuarÃ¡ oculta ou comentada -->
    <!--    <table class="table table-striped">-->
    <!--        <thead>-->
    <!--            <tr>-->
    <!--                <th>Codigo</th>-->
    <!--                <th>Nome</th>-->
    <!--            </tr>-->
    <!--        </thead>-->
    <!--        <tbody class="table-group-divider">-->
    <!--            <tr th:each="marca : ${marcas}">-->
    <!--                <td th:text="${marca.getCodigo()}">teste</td>-->
    <!--                <td th:text="${marca.getNome()}"></td>-->
    <!--            </tr>-->
    <!--        </tbody>-->
    <!--    </table>-->
</div>

<script>
    document.getElementById('marcas').addEventListener('change', function () {
        const marcaCodigo = this.value;
        const modeloSelect = document.getElementById('modelos');

        if (marcaCodigo === "0") {
            modeloSelect.innerHTML = '<option selected value="0">-- Selecione um modelo --</option>';
            modeloSelect.disabled = true;
            return;
        }

        fetch('/modelos/' + marcaCodigo)
            .then(response => response.json())
            .then(data => {
                modeloSelect.innerHTML = '<option selected value="0">-- Selecione um modelo --</option>';
                data.forEach(modelo => {
                    const option = document.createElement('option');
                    option.value = modelo.codigo;
                    option.textContent = modelo.nome;
                    modeloSelect.appendChild(option);
                });
                modeloSelect.disabled = false;
            })
            .catch(error => {
                console.error('Erro ao buscar modelos:', error);
                modeloSelect.disabled = true;
            });
    });
</script>
</body>
</html>
